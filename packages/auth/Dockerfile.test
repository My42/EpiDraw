FROM node:12.13.1

# FOR CIRCLE.CI
LABEL com.circleci.preserve-entrypoint=true
ENTRYPOINT contacts

RUN pwd

WORKDIR /usr/app

RUN pwd

WORKDIR /epidraw/packages/shared
COPY ./shared .
RUN ls
RUN npm update
RUN npm install

WORKDIR /epidraw/packages/auth
COPY ./auth .
RUN npm update
RUN npm install

RUN pwd
RUN ls

ENV APP_ENV TEST

CMD ["npm", "test"]

EXPOSE 8081
